# 多指标异常归因的分析

怎么判断一个指标是否异常？多个指标异常的时候，怎么判断哪个指标影响大

> 异动分析中，在通过指标拆解和维度拆解确定问题原因的过程中，经常会碰到的一个问题就是：「多个因素混合导致整体指标下跌的情境下，各个因素对指标波动的影响程度分别是多少？」



## 1. 怎么判断一个指标是异常的？

不同业务有不同的标准，但一般情况下：

这个需要测算一下这个指标的波动，对核心指标的影响是多大，明确这个波动的标准后，依据业务方可以接受的日常波动量级确定闻值，超过了就认为指标异常，否则就是日常波动



## 2. 如何判断哪个指标的影响大?

本质上是贡献度测算的问题

这里的多个指标异常，暂且理解为是一个核心指标拆解为的多个子指标的异常判断

这样的话，在日常的异动分析中，基本考虑三种情况，核心指标拆解基本就是加法乘法，除法，加法好说就是加和计算

- 加法型计算：指标总体变化量等于各子维度指标变化量之和
- 乘法型计算：总体指标是由各子指标相乘
- 除法型计算：比值型指标，总体指标是由各子指标相除



#### 加法型计算

加法型计算中，不同维度值之间可直接累加，指标总体变化量等于各子维度指标变化量之和，即:

$$
\Delta X=\Delta x_1+\Delta x_2+...+\Delta x_n
$$

每一个因素的贡献度是：

$$
C_i=\frac{\Delta x_i}{\Delta X}
$$

比如2024.01.23当日的GMV为1,000,000，而该日当周的GMV总量为20,000,000，那么:

$$
C_{2024.01.23对当周GMV的贡献度}=\frac{1,000,000}{20,000,000}\times 100\%=5\%
$$


#### 乘法型计算

乘法型计算中，总体指标由各维度指标相乘得出：

$$
X=x_1 \times x_2 \times ... \times x_n
$$

此时，每一个因素对总体结果的贡献度，是将公式两端指标取对数，将其转换成加法型进行计算：

$$
log(X)=log(x_1)+...+log(x_n)
$$

而后转化为加法进行计算



#### 除法型计算

除法型计算，也就是比值类计算，总体指标是由各子指标相除得出，如:

$$
I_{Rate}=\frac{I_1}{I_2}*100\%
$$


除法型指标在发生变动时，往往涉及到分子、分母的同时改变，在计算贡献度时需要同时考虑指标本身及其占比结构改变带来的影响。



> 比如，某周期某商品付费率 =付费用户数 / 总用户数
>
> ![](https://github.com/SIHENG98/DA-NOTE/blob/main/Part%20II%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/1-%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90/%E6%A1%88%E4%BE%8B-%E9%99%A4%E6%B3%95%E5%9E%8B%E6%8C%87%E6%A0%8701.png)
>
> 上图是按用户新鲜度拆分的客群流失数据，单独看每个维度客群的付费率都提高了，但是整体付费率却是下降的，这是总体用户的内部结构变化导致的“辛普森悖论"现象。
>
> 按照「结构变化」和「核心指标变化」进行拆解，计算分群用户的「付费率」和「用户结构」对总体付费率的贡献度:
>
> - 结构变化：假设付费率指标为基期同水平情况下，客群结构变化带来的影响
> - 指标变化：假设用户结构与基期同水平情况下，付费率变化带来的影响


&nbsp;
分析过程：

1. **结构变化**：计算客群结构变化折合大盘绝对变化（假设付费率没变）

   计算维度基期付费率与总体结果的差距，然后根据维度用户数的变化，这算维度用户数变化对于整体付费率指标的影响。

   以新客为例:

   <img src="https://github.com/SIHENG98/DA-NOTE/blob/main/Part%20II%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/1-%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90/%E6%A1%88%E4%BE%8B-%E9%99%A4%E6%B3%95%E5%9E%8B%E6%8C%87%E6%A0%8702.png" style="zoom:50%;" />

 &nbsp;
 
   $$
   F_{结构变化：新客}=(付费率_{基期_{新客}}-付费率_{现期_{新客}})\times \frac{用户_{现期_{新客}}-用户_{基期_{新客}}}{用户_{现期_{总体}}}
   $$


3. **指标变化**：付费率变化折合成大盘绝对变化(假设用户流量没变)

   以新客为例：

   <img src="https://github.com/SIHENG98/DA-NOTE/blob/main/Part%20II%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/1-%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90/%E6%A1%88%E4%BE%8B-%E9%99%A4%E6%B3%95%E5%9E%8B%E6%8C%87%E6%A0%8703.png" style="zoom:50%;" />

&nbsp;

   $$
   F_{指标变化：新客}=(付费率_{现期_{新客}}-付费率_{基期_{新客}})\times \frac{用户_{现期_{新客}}}{用户_{现期_{总体}}}
   $$


4. **汇总变化**：汇总[**结构变化**]及[**指标变化**]

   以新客为例：

   <img src="https://github.com/SIHENG98/DA-NOTE/blob/main/Part%20II%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/1-%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90/%E6%A1%88%E4%BE%8B-%E9%99%A4%E6%B3%95%E5%9E%8B%E6%8C%87%E6%A0%8704.png" style="zoom:50%;" />
&nbsp;

   $$
   F_{变化：新客}=F_{结构变化：新客}+F_{指标变化：新客}
   $$

5. **计算各维度对大盘贡献度**

   <img src="https://github.com/SIHENG98/DA-NOTE/blob/main/Part%20II%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/1-%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90/%E6%A1%88%E4%BE%8B-%E9%99%A4%E6%B3%95%E5%9E%8B%E6%8C%87%E6%A0%8705.png" style="zoom:50%;" />
&nbsp;

   $$
   C_{新客}=\frac{F_{变化：新客}}{指标增长率_{总量和}} \times 100\%
   $$

**汇总结果及解释：**

<img src="https://github.com/SIHENG98/DA-NOTE/blob/main/Part%20II%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/1-%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90/%E6%A1%88%E4%BE%8B-%E9%99%A4%E6%B3%95%E5%9E%8B%E6%8C%87%E6%A0%8706.png" style="zoom:50%;" />



> 归因结论，现期付费率下跌1.5%，主要受客群变化导致，其中：
>
> - 新客用户群贡献了跌幅的105%
> - 存量用户贡献跌幅的34%
> - 次新用户贡献跌幅的40%，使总体跌幅收窄





















